import { create } from 'zustand'
import type { Level } from '../types/index'

interface GameState {
  levels: Level[]
  currentGrade: number | null
  currentLevel: Level | null
  setLevels: (levels: Level[]) => void
  setCurrentGrade: (grade: number) => void
  setCurrentLevel: (level: Level) => void
  getLevelsByGrade: (grade: number) => Level[]
}

// Дефолтные уровни для каждого класса
const defaultLevels: Level[] = [
  {
    id: '1-1',
    title: 'Деньги и их назначение',
    description: 'Узнайте, для чего нужны деньги',
    grade: 1,
    questions: [
      {
        id: 'q1',
        text: 'Для чего нужны деньги?',
        choices: ['Для игр', 'Для покупки товаров', 'Для украшения', 'Для коллекции'],
        correctIndex: 1,
        explanation: 'Деньги нужны для обмена на товары и услуги.',
      },
    ],
    reward: { coinsPerCorrect: 10, pointsPerCorrect: 10 },
  },
  {
    id: '2-1',
    title: 'Знакомство с деньгами',
    description: 'Что такое деньги и откуда они берутся',
    grade: 2,
    questions: [
      {
        id: 'q2-1',
        text: 'Откуда взрослые получают деньги?',
        choices: ['Из тумбочки', 'На работе за труд', 'В магазине', 'Находят на улице'],
        correctIndex: 1,
        explanation: 'Люди получают зарплату за свою работу, это их основной источник дохода.',
      },
    ],
    reward: { coinsPerCorrect: 10, pointsPerCorrect: 10 },
  },
  {
    id: '3-1',
    title: 'Хочу и Надо',
    description: 'Учимся отличать потребности от желаний',
    grade: 3,
    questions: [
      {
        id: 'q3-1',
        text: 'Что из этого является жизненно важной потребностью?',
        choices: ['Новая игрушка', 'Еда и вода', 'Билет в кино', 'Мороженое'],
        correctIndex: 1,
        explanation: 'Потребности — это то, без чего человек не может жить: еда, вода, одежда, жилье.',
      },
    ],
    reward: { coinsPerCorrect: 10, pointsPerCorrect: 10 },
  },
  {
    id: '4-1',
    title: 'Первые сбережения',
    description: 'Зачем и как копить деньги',
    grade: 4,
    questions: [
      {
        id: 'q4-1',
        text: 'Зачем нужно копить деньги?',
        choices: ['Чтобы они просто лежали', 'Чтобы купить что-то большое и дорогое в будущем', 'Чтобы хвастаться перед друзьями', 'Чтобы их потерять'],
        correctIndex: 1,
        explanation: 'Сбережения помогают достигать финансовых целей, например, купить велосипед или поехать в путешествие.',
      },
    ],
    reward: { coinsPerCorrect: 10, pointsPerCorrect: 10 },
  },
  {
    id: '5-1',
    title: 'Личный бюджет',
    description: 'Что такое доходы и расходы',
    grade: 5,
    questions: [
      {
        id: 'q5-1',
        text: 'Что такое "доходы" в личном бюджете?',
        choices: ['Деньги, которые тратят', 'Деньги, которые получают', 'Деньги, которые дарят друзьям', 'Деньги, которые теряют'],
        correctIndex: 1,
        explanation: 'Доходы — это все деньги, которые поступают в твой бюджет (зарплата, подарки, карманные деньги).',
      },
    ],
    reward: { coinsPerCorrect: 10, pointsPerCorrect: 10 },
  },
  {
    id: '6-1',
    title: 'Знакомство с банком',
    description: 'Зачем нужны банки и что такое вклад',
    grade: 6,
    questions: [
      {
        id: 'q6-1',
        text: 'Какая основная функция банка?',
        choices: ['Продавать игрушки', 'Хранить деньги и выдавать кредиты', 'Печатать деньги', 'Проводить концерты'],
        correctIndex: 1,
        explanation: 'Банки — это финансовые организации, которые помогают управлять деньгами: хранить, переводить, брать в долг.',
      },
    ],
    reward: { coinsPerCorrect: 12, pointsPerCorrect: 15 },
  },
  // 7 класс - Глобальные компетенции
  {
    id: '7-1',
    title: 'Человек и современный мир',
    description: 'Глобальные проблемы и ценности (по учебнику Аскаровой Г.С.)',
    grade: 7,
    questions: [
      {
        id: 'q7-1',
        text: 'Что подразумевается под понятием «глобальная гражданственность»?',
        choices: ['Отказ от своей национальности', 'Осознание себя частью мирового сообщества и ответственность за планету', 'Возможность путешествовать без виз', 'Знание всех языков мира'],
        correctIndex: 1,
        explanation: 'Глобальная гражданственность — это понимание того, что мы все связаны, и наши действия влияют на мир в целом.',
      },
      {
        id: 'q7-2',
        text: 'Какое качество необходимо для успешного межкультурного общения?',
        choices: ['Толерантность и уважение', 'Настойчивость', 'Безразличие', 'Закрытость'],
        correctIndex: 0,
        explanation: 'Толерантность (терпимость) и уважение к чужим традициям и взглядам являются основой мирного взаимодействия культур.',
      },
      {
        id: 'q7-3',
        text: 'Что из перечисленного относится к глобальным экологическим проблемам?',
        choices: ['Шум в школьном коридоре', 'Изменение климата и загрязнение океана', 'Невыученный урок', 'Сломанная скамейка в парке'],
        correctIndex: 1,
        explanation: 'Изменение климата — это проблема, которая затрагивает все страны и требует объединения усилий всего человечества.',
      }
    ],
    reward: { coinsPerCorrect: 12, pointsPerCorrect: 15 },
  },
  {
    id: '8-1',
    title: 'Финансовая безопасность',
    description: 'Как защитить свои деньги от мошенников',
    grade: 8,
    questions: [
      {
        id: 'q8-1',
        text: 'Что НЕЛЬЗЯ сообщать посторонним, чтобы не украли деньги с карты?',
        choices: ['Своё имя', 'Номер телефона', 'CVV-код (три цифры на обороте карты)', 'Любимый цвет'],
        correctIndex: 2,
        explanation: 'CVV-код, PIN-код и одноразовые пароли из СМС — это ключи к вашим деньгам, их нельзя никому сообщать.',
      },
    ],
    reward: { coinsPerCorrect: 12, pointsPerCorrect: 15 },
  },
  {
    id: '9-1',
    title: 'Основы инвестирования',
    description: 'Чем инвестиции отличаются от сбережений',
    grade: 9,
    questions: [
      {
        id: 'q9-1',
        text: 'В чем главный риск инвестиций по сравнению со сбережениями на вкладе?',
        choices: ['Деньги могут украсть', 'Можно не только не заработать, но и потерять вложенные деньги', 'Банк может закрыться', 'Инфляция съест доход'],
        correctIndex: 1,
        explanation: 'Инвестиции всегда связаны с риском. В отличие от банковского вклада, доход не гарантирован, и можно потерять часть или все средства.',
      },
    ],
    reward: { coinsPerCorrect: 12, pointsPerCorrect: 15 },
  },
  // 10 класс - Основы предпринимательства
  {
    id: '10-1',
    title: 'Введение в предпринимательство',
    description: 'Сущность предпринимательства, виды и формы бизнеса (по учебнику Дүйсенханова Е.)',
    grade: 10,
    questions: [
      {
        id: 'q10-1',
        text: 'Что является основной целью предпринимательской деятельности?',
        choices: ['Благотворительность', 'Получение прибыли', 'Уплата налогов', 'Создание рабочих мест'],
        correctIndex: 1,
        explanation: 'Предпринимательство — это инициативная деятельность, направленная на получение чистого дохода.',
      },
      {
        id: 'q10-2',
        text: 'Кто такой предприниматель?',
        choices: ['Наемный работник', 'Инвестор', 'Человек, готовый идти на риск ради прибыли', 'Государственный служащий'],
        correctIndex: 2,
        explanation: 'Предприниматель — это новатор, который использует новые технологии и возможности, принимая на себя риски.',
      },
      {
        id: 'q10-3',
        text: 'Что такое стартап?',
        choices: ['Крупная корпорация', 'Временная структура для поиска масштабируемой бизнес-модели', 'Государственное предприятие', 'Благотворительный фонд'],
        correctIndex: 1,
        explanation: 'Стартап — это компания с короткой историей операционной деятельности, создающая инновационный продукт.',
      }
    ],
    reward: { coinsPerCorrect: 15, pointsPerCorrect: 20 },
  },
  {
    id: '10-2',
    title: 'Дизайн-мышление',
    description: 'Генерация бизнес-идей и понимание клиента',
    grade: 10,
    questions: [
      {
        id: 'q10-4',
        text: 'Какой первый этап в методологии дизайн-мышления?',
        choices: ['Прототипирование', 'Тестирование', 'Эмпатия', 'Идеация'],
        correctIndex: 2,
        explanation: 'Эмпатия — это этап погружения в опыт пользователя для понимания его истинных потребностей.',
      }
    ],
    reward: { coinsPerCorrect: 15, pointsPerCorrect: 20 },
  },
  // 11 класс - Бизнес-планирование и управление
  {
    id: '11-1',
    title: 'Бизнес-моделирование',
    description: 'Построение бизнес-модели Canvas',
    grade: 11,
    questions: [
      {
        id: 'q11-1',
        text: 'Сколько блоков включает в себя шаблон бизнес-модели Остервальдера (Canvas)?',
        choices: ['5', '7', '9', '10'],
        correctIndex: 2,
        explanation: 'Бизнес-модель Canvas состоит из 9 ключевых блоков, описывающих деятельность компании.',
      },
      {
        id: 'q11-2',
        text: 'Что такое ценностное предложение?',
        choices: ['Цена товара', 'Совокупность преимуществ, которые компания предлагает клиенту', 'Рекламная кампания', 'Бренд компании'],
        correctIndex: 1,
        explanation: 'Ценностное предложение объясняет, почему клиент должен выбрать именно ваш продукт.',
      }
    ],
    reward: { coinsPerCorrect: 20, pointsPerCorrect: 30 },
  },
  // ... остальные уровни будут добавлены после загрузки с API
]

export const useGameStore = create<GameState>((set, get) => ({
  levels: defaultLevels,
  currentGrade: null,
  currentLevel: null,
  setLevels: (levels) => set({ levels }),
  setCurrentGrade: (grade) => set({ currentGrade: grade }),
  setCurrentLevel: (level) => set({ currentLevel: level }),
  getLevelsByGrade: (grade) => {
    const { levels } = get()
    return levels.filter((level) => level.grade === grade)
  },
}))
